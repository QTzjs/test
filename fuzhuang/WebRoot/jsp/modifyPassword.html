<script>
     $(function (){
        $.ajax({
           type:"post",
           url:"logingetUser.action",
           success:function (admin) { 
	            var json = eval("(" + admin + ")");
			    var name = json.name;
			    var pass = json.pass;
			    var id = json.id;
			    document.getElementById("userNameId").value=name;
	            document.getElementById("userName").value=pass;
	            document.getElementById("id").value=id;
	        }, 
	       error:function () { 
	              
	       } 
	   });
	    $(document).on('blur','input',function(){
	        var $password=$('#password').val();
	        var $password_again=$('#password_again').val();
	        if(!$password){
	              $("#password").addClass('redBorder').next('label').show().html('不能为空');;
	              return false;
	        }else if(!$password_again){
	              $("#password_again").addClass('redBorder').next('label').show().html('不能为空');
	              return false;
	        }else{
	              $('input').removeClass('redBorder').next('label').empty();
	              if($password_again==$password){
	                     $("#password,#password_again").next('label').show().html('').addClass('valid');
	              }else if($password_again!=$password){
	                     $("#password,#password_again").addClass('redBorder').next('label').show().html('两次密码不一致').removeClass('valid').addClass('erro');
	               }
	  
	        } 
      }); 
     $("#submit").click(function(){
          var password=document.getElementById("password").value;
          var password_again=document.getElementById("password_again").value;
	      var id=document.getElementById("id").value;
	      var passwd=document.getElementById("userName").value;
          if(password_again!=password||password==""){
		      alert("密码不一致或密码为空");
          }else if(passwd==password){
              alert("密码不能和原密码一致");
          }else{
             $.ajax({
		           type:"post",
		           url:"loginupdatePass.action?id="+id+"&password="+password,
		           success:function (date) { 
			            var json = eval("(" + date + ")");
                        var result=json.success;
                        alert(result);
	                    window.location.href="login.jsp";
			        }, 
			       error:function () { 
			            alert("修改失败请重新提交");  
			       } 
			 });     
          }
     });
    });
</script> 
<style>
    .redBorder{
      border: 1px solid red;
    }
    .erro{
      padding-left: 16px;
    }
    .valid{
      width: 16px;
      height: 16px;
    }
  </style> 
<style>
    .editTable .label {
        min-width: 80px;
        width: 80px;
    }
</style>
<table class="editTable" >
    <tr>
        <td class="label">用户名</td>
        <td><input type="text" id="userNameId" name="userNameId" value="" readonly="readonly" style="width:100px;height:25px"></td>
    </tr>
    <tr><td>  <label ><input type="hidden" value="" id="id"></label></td></tr>
    <tr>
        <td class="label">旧密码</td>
        <td><input type="password" id="userName" name="userName" value="" readonly="readonly" style="width:100px;height:25px"></td>
    </tr>
      <tr><td>  <label ></label></td></tr>
    <tr>
        <td class="label">新密码</td>
        <td><input type="text" placeholder="输入新密码" id="password"name="password"  style="width:100px;height:25px">
        <label id="password-erro" class="erro" style="display:none;"></label></td>
    </tr>
      <tr><td>  <label ></label></label></td></tr>
    <tr>
        <td class="label">确认新密码</td>
        <td><input type="text" placeholder="确认密码" id="password_again" name="password2"  style="width:100px;height:25px" ><label id="password-erro" class="erro" style="display:none;"></label></td>
    </tr>
    <tr><td>  <label ></label></td></tr>
    <tr><td ></td><td> <input id="submit" type="button" value="提交" > </td></tr>
</table>